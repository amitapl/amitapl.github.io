
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="last-modified" content="2020-05-28T20:51:05.6982304+00:00" />
    <meta name="keywords" content="Azure Mobile Services" />
    <title>Blog.Amit Apple</title>
    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="/stylesheets/prettify.css">
    <link href="/stylesheets/styles.css" rel="stylesheet" media="screen">

    <script type="text/javascript">
        window.appInsights={queue:[],applicationInsightsId:null,accountId:null,appUserId:null,configUrl:null,start:function(n){function u(n){t[n]=function(){var i=arguments;t.queue.push(function(){t[n].apply(t,i)})}}function f(n,t){if(n){var u=r.createElement(i);u.type="text/javascript";u.src=n;u.async=!0;u.onload=t;u.onerror=t;r.getElementsByTagName(i)[0].parentNode.appendChild(u)}else t()}var r=document,t=this,i;t.applicationInsightsId=n;u("logEvent");u("logPageView");i="script";f(t.configUrl,function(){f("//az416426.vo.msecnd.net/scripts/a/ai.0.7.js")});t.start=function(){}}};
        
        appInsights.start("21e48bf6-b6c7-4526-99b0-8afef5a10e20");
        appInsights.logPageView();
    </script>

    <link rel="canonical" href="https://blog.amitapple.com/post/32655170474/joinedtablesview" />
</head>
<body>
    <div class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/"><img class="img img-circle" src="https://www.gravatar.com/avatar/39b6f2748dea9f8eef5323c14e7be79d.jpg?s=80" /></a>
            </div>
            <ul class="nav navbar-nav">
                <li><a style="font-weight: bold" href="/">Blog.Amit Apple</a></li>
            </ul>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/">Home</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/category">Categories</a></li>
                    <li><a href="/archive">Archive</a></li>
                    <li><a href="/feed.xml">RSS</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </div>

    

    <div class="container">

        <div class="row">
            

<div class="blog-main" id="post">
    <h1 class="blog-post-title">Joined Tables View in Windows Azure Mobile Services</h1>

    <div class="blog-post-meta">
        posted on 30 Sep 2012
            | <a class="label label-info" href="/category/azure-mobile-services">Azure Mobile Services</a>
    </div>

    <div class="row">
        <!-- AddThis Button BEGIN -->
        <div class="addthis_toolbox addthis_default_style row pull-right" style="margin:10px">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
        </div>
        <script type="text/javascript">var addthis_config = { "data_track_addressbar": true };</script>
        <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-537248a1187b7a5c"></script>
    </div>
    <div class="blog-post">
        <!-- AddThis Button END -->
        

        <p>Windows Azure Mobile Services is using SQL Azure as the backend, one of the benefits you have with a SQL database is the ability to join tables simply, but currently that ability is not manifested in an easy way through the server-side scripts or the client SDK of the mobile services.</p>

<p>So when I needed to get rows by joining 2 tables, I used this following simple solution.</p>

<p>In my case I had 2 tables, one for users with the user id and user name among other columns, and the other for user groups with information on which user is a part of which group, there I had the same user id with other group related information.</p>

<p>I needed a view with all of the user group columns together with the name of the user.</p>

<p>To do that I've created a new table called <strong>UserGroupsExtended</strong> and I've set permissions to admin for all operations except read, this is a workaround for creating a new endpoint in our mobile service.</p>

<p><img src="/images/2012-09-30-joined-tables-view.md1.jpg" alt="" /></p>

<p>In the read operation server-side script of this new table, I have the following code in which I use a SQL query to join the 2 tables and return the results of that query (instead of returning results related to the original UserGroupsExtended table which will always be empty).</p>

<script src="https://gist.github.com/3809541.js?file=UserGroupExtended.read.js"></script>

<p>In this script I actually do more than that, I use a custom parameter (as described <a href="/post/30921523746/customparametersinmobileservices" title="custom parameters in mobile services">here</a>) to pass the specific group id I want to get results on, this is since the query object is for the original UserGroupsExtended table which we are not really using.</p>

<p>And I also added this "in" part to only get results for groups where the current user is part of.</p>

<p>On the client side I've added a new UserGroupExtended class which derives from UserGroup and adds the user name as a property.</p>

<script src="https://gist.github.com/3809541.js?file=UserGroupExtended.cs"></script>

<p>And the last piece is for actually getting a result back from this new view.</p>

<script src="https://gist.github.com/3809541.js?file=Data.cs"></script>

<p>The last piece assumes you have the client-side code mentioned on the <a href="/post/30921523746/customparametersinmobileservices" title="custom parameters in mobile services">custom parameters post</a>.</p>

    </div>

    <div id="disqus_thread"></div>
<script>
    var reset_disqus = function(){
        DISQUS.reset({
            reload: true,
            config: function () {
                //this.page.identifier = '';
                this.page.url = 'https://blog.amitapple.com/post/32655170474/joinedtablesview';
                //this.page.title = '';
            }
        });
    };

    var disqus_shortname = 'blogamitapple';
    var disqus_url = 'https://blog.amitapple.com/post/32655170474/joinedtablesview';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    window.addEventListener('orientationchange', reset_disqus);
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

        </div>

        <hr>

        <footer>
            <p>&copy; 2014 - Powered by <a href="https://github.com/Sandra/Sandra.Snow" rel="generator">Sandra.Snow</a>.</p>
        </footer>
    </div> <!-- /container -->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/javascripts/bootstrap.min.js"></script>
    <script src="/javascripts/prettify.js"></script>

    <script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-34307246-1']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>

    <script>
        $('pre').addClass('prettyprint');
        !function ($) {
            $(function () {
                window.prettyPrint && prettyPrint()
            })
        }(window.jQuery)
    </script>
</body>
</html>
